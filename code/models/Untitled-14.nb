(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     48538,       1513]
NotebookOptionsPosition[     42097,       1391]
NotebookOutlinePosition[     42608,       1411]
CellTagsIndexPosition[     42565,       1408]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.842366126217332*^9, 3.8423661358506002`*^9}},
 CellLabel->
  "In[123]:=",ExpressionUUID->"0a376c8b-5438-4500-9389-a272f1f6bf6f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"dy1", " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"-", 
     RowBox[{"(", 
      RowBox[{"1", "+", "d"}], ")"}]}], " ", 
    RowBox[{"y1", "[", "t", "]"}]}], "+", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"y1", "[", "t", "]"}], "+", 
      RowBox[{"y2", "[", "t", "]"}]}], ")"}], 
    RowBox[{
     RowBox[{"x", "[", "t", "]"}], "/", "2"}]}]}]}]], "Input",
 CellChangeTimes->{{3.842366137833345*^9, 3.842366161831509*^9}},
 CellLabel->
  "In[124]:=",ExpressionUUID->"9019f713-677f-4a78-b147-7f02b02d6938"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "-", "d"}], ")"}], " ", 
   RowBox[{"y1", "[", "t", "]"}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"x", "[", "t", "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"y1", "[", "t", "]"}], "+", 
     RowBox[{"y2", "[", "t", "]"}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{3.842366162372621*^9, 3.842367182551569*^9, 
  3.842367442476309*^9},
 CellLabel->
  "Out[124]=",ExpressionUUID->"453d73e1-8f9e-4bed-81d5-3ef0594e65d2"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"dy2", " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"-", 
     RowBox[{"(", 
      RowBox[{"1", "-", "d"}], ")"}]}], " ", 
    RowBox[{"y2", "[", "t", "]"}]}], "+", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"y1", "[", "t", "]"}], "+", 
      RowBox[{"y2", "[", "t", "]"}]}], ")"}], 
    RowBox[{
     RowBox[{"x", "[", "t", "]"}], "/", "2"}]}]}]}]], "Input",
 CellChangeTimes->{{3.842366169151853*^9, 3.842366172720807*^9}},
 CellLabel->
  "In[125]:=",ExpressionUUID->"61d84857-1bd8-416f-a38b-f82108d7fcf6"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", 
   RowBox[{"y2", "[", "t", "]"}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"x", "[", "t", "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"y1", "[", "t", "]"}], "+", 
     RowBox[{"y2", "[", "t", "]"}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{3.8423661733320704`*^9, 3.8423671833560543`*^9, 
  3.842367442519248*^9},
 CellLabel->
  "Out[125]=",ExpressionUUID->"c09efc81-b6ff-41da-b275-fdd43f7802b6"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"dx", "=", 
  RowBox[{
   RowBox[{"x", "[", "t", "]"}], 
   RowBox[{"(", 
    RowBox[{"1", "  ", "-", " ", 
     RowBox[{"y1", "[", "t", "]"}], "-", 
     RowBox[{"y2", "[", "t", "]"}]}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.842366179543426*^9, 3.8423661941471786`*^9}},
 CellLabel->
  "In[126]:=",ExpressionUUID->"b9fdbe58-b54a-4445-88e4-af73e6b51f4f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"x", "[", "t", "]"}], " ", 
  RowBox[{"(", 
   RowBox[{"1", "-", 
    RowBox[{"y1", "[", "t", "]"}], "-", 
    RowBox[{"y2", "[", "t", "]"}]}], ")"}]}]], "Output",
 CellChangeTimes->{3.842366194566924*^9, 3.8423671841520967`*^9, 
  3.8423674425646343`*^9},
 CellLabel->
  "Out[126]=",ExpressionUUID->"84e1b5b6-e9b1-497c-b729-9426a31d1350"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"dy1", "\[Equal]", "0"}], ",", 
      RowBox[{"dy2", "\[Equal]", "0"}], ",", 
      RowBox[{"dx", "\[Equal]", "0"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"y1", "[", "t", "]"}], ",", 
      RowBox[{"y2", "[", "t", "]"}], ",", 
      RowBox[{"x", "[", "t", "]"}]}], "}"}]}], "]"}], "[", 
  RowBox[{"[", "2", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.842367185156893*^9, 3.842367212119689*^9}},
 CellLabel->
  "In[127]:=",ExpressionUUID->"19562127-2b7f-404f-8cc7-b60485561365"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"y1", "[", "t", "]"}], "\[Rule]", 
    FractionBox[
     RowBox[{"1", "-", "d"}], "2"]}], ",", 
   RowBox[{
    RowBox[{"y2", "[", "t", "]"}], "\[Rule]", 
    FractionBox[
     RowBox[{"1", "+", "d"}], "2"]}], ",", 
   RowBox[{
    RowBox[{"x", "[", "t", "]"}], "\[Rule]", 
    RowBox[{"1", "-", 
     SuperscriptBox["d", "2"]}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.84236720789207*^9, 3.842367212619544*^9}, 
   3.842367442612216*^9},
 CellLabel->
  "Out[127]=",ExpressionUUID->"9a65f59a-c146-461a-b9d0-dc8840c32831"]
}, Open  ]],

Cell["\<\
Perform a change of variables: z = y1 + y2, \[Theta] = ((1+d) y1 + (1-d) \
y2)/(y1 + y2)\[LineSeparator]\
\>", "Text",
 CellChangeTimes->{{3.8423661961032248`*^9, 
  3.84236624216356*^9}},ExpressionUUID->"a486fd75-f594-4e76-bb72-\
7e9ab8d1839d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ch", "=", 
  RowBox[{
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"z", "[", "t", "]"}], "\[Equal]", 
        RowBox[{
         RowBox[{"y1", "[", "t", "]"}], "+", 
         RowBox[{"y2", "[", "t", "]"}]}]}], ",", 
       RowBox[{
        RowBox[{"\[Theta]", "[", "t", "]"}], "\[Equal]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "+", "d"}], ")"}], " ", 
            RowBox[{"y1", "[", "t", "]"}]}], " ", "+", " ", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", "d"}], ")"}], " ", 
            RowBox[{"y2", "[", "t", "]"}]}]}], ")"}], "/", 
         RowBox[{"z", "[", "t", "]"}]}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"y1", "[", "t", "]"}], ",", 
       RowBox[{"y2", "[", "t", "]"}]}], "}"}]}], "]"}], "[", 
   RowBox[{"[", "1", "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8423662452789087`*^9, 3.8423663071535063`*^9}},
 CellLabel->
  "In[128]:=",ExpressionUUID->"3dcec831-8193-4176-a20a-45946938e0aa"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"y1", "[", "t", "]"}], "\[Rule]", 
    RowBox[{"-", 
     FractionBox[
      RowBox[{
       RowBox[{"z", "[", "t", "]"}], "-", 
       RowBox[{"d", " ", 
        RowBox[{"z", "[", "t", "]"}]}], "-", 
       RowBox[{
        RowBox[{"z", "[", "t", "]"}], " ", 
        RowBox[{"\[Theta]", "[", "t", "]"}]}]}], 
      RowBox[{"2", " ", "d"}]]}]}], ",", 
   RowBox[{
    RowBox[{"y2", "[", "t", "]"}], "\[Rule]", 
    RowBox[{"-", 
     FractionBox[
      RowBox[{
       RowBox[{"-", 
        RowBox[{"z", "[", "t", "]"}]}], "-", 
       RowBox[{"d", " ", 
        RowBox[{"z", "[", "t", "]"}]}], "+", 
       RowBox[{
        RowBox[{"z", "[", "t", "]"}], " ", 
        RowBox[{"\[Theta]", "[", "t", "]"}]}]}], 
      RowBox[{"2", " ", "d"}]]}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.842366291449243*^9, 3.842366307499889*^9}, 
   3.84236744265659*^9},
 CellLabel->
  "Out[128]=",ExpressionUUID->"3eb93761-2a39-45b0-bec5-b61d7f234961"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"dz", " ", "=", " ", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"y1", "[", "t", "]"}], "+", 
        RowBox[{"y2", "[", "t", "]"}]}], ",", "t"}], "]"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{
         SuperscriptBox["y1", "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}], "\[Rule]", "dy1"}], ",", 
       
       RowBox[{
        RowBox[{
         SuperscriptBox["y2", "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}], "\[Rule]", "dy2"}]}], 
      "}"}]}], "/.", "ch"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.842366295798068*^9, 3.842366349216082*^9}},
 CellLabel->
  "In[129]:=",ExpressionUUID->"cba74860-1e44-4960-9665-52dc01cc6148"],

Cell[BoxData[
 RowBox[{
  RowBox[{"z", "[", "t", "]"}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"x", "[", "t", "]"}], "-", 
    RowBox[{"\[Theta]", "[", "t", "]"}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.842366319530746*^9, 3.842366349600865*^9}, 
   3.8423674426970177`*^9},
 CellLabel->
  "Out[129]=",ExpressionUUID->"30e813c6-10a3-4ba8-b31c-079e2b058630"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"d\[Theta]", " ", "=", " ", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "+", "d"}], ")"}], " ", 
           RowBox[{"y1", "[", "t", "]"}]}], " ", "+", " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", "d"}], ")"}], " ", 
           RowBox[{"y2", "[", "t", "]"}]}]}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"y1", "[", "t", "]"}], "+", 
          RowBox[{"y2", "[", "t", "]"}]}], ")"}]}], ",", "t"}], "]"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{
         SuperscriptBox["y1", "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}], "\[Rule]", "dy1"}], ",", 
       
       RowBox[{
        RowBox[{
         SuperscriptBox["y2", "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}], "\[Rule]", "dy2"}]}], 
      "}"}]}], "/.", "ch"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.842366355881768*^9, 3.842366384203807*^9}},
 CellLabel->
  "In[130]:=",ExpressionUUID->"c41e5fa6-24b0-4d5b-a47e-e4d9539c228d"],

Cell[BoxData[
 RowBox[{"1", "-", 
  SuperscriptBox["d", "2"], "+", 
  RowBox[{"x", "[", "t", "]"}], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"2", "+", 
     RowBox[{"x", "[", "t", "]"}]}], ")"}], " ", 
   RowBox[{"\[Theta]", "[", "t", "]"}]}], "+", 
  SuperscriptBox[
   RowBox[{"\[Theta]", "[", "t", "]"}], "2"]}]], "Output",
 CellChangeTimes->{3.842366384905168*^9, 3.842367442742976*^9},
 CellLabel->
  "Out[130]=",ExpressionUUID->"a66e592e-8c88-4027-8977-32149b78a164"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"dx", "=", " ", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{"dx", "/.", "ch"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8423666513857594`*^9, 3.842366663354648*^9}},
 CellLabel->
  "In[131]:=",ExpressionUUID->"9052f7bf-4079-4ea4-a8be-f14fda4f6bb2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   RowBox[{"x", "[", "t", "]"}]}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", "1"}], "+", 
    RowBox[{"z", "[", "t", "]"}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.842366655022896*^9, 3.842366663684451*^9}, 
   3.842367442786504*^9},
 CellLabel->
  "Out[131]=",ExpressionUUID->"f6802ad5-ea27-4e91-9508-d30f3e742be7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"dz", "\[Equal]", "0"}], ",", 
      RowBox[{"d\[Theta]", "\[Equal]", "0"}], ",", 
      RowBox[{"dx", "\[Equal]", "0"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"x", "[", "t", "]"}], ",", 
      RowBox[{"z", "[", "t", "]"}], ",", 
      RowBox[{"\[Theta]", "[", "t", "]"}]}], "}"}]}], "]"}], "[", 
  RowBox[{"[", "3", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.842373060880636*^9, 3.842373085312684*^9}},
 CellLabel->
  "In[158]:=",ExpressionUUID->"668d40c6-8b43-437e-a808-db5eb45a9d3a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"x", "[", "t", "]"}], "\[Rule]", 
    RowBox[{"1", "-", 
     SuperscriptBox["d", "2"]}]}], ",", 
   RowBox[{
    RowBox[{"z", "[", "t", "]"}], "\[Rule]", "1"}], ",", 
   RowBox[{
    RowBox[{"\[Theta]", "[", "t", "]"}], "\[Rule]", 
    RowBox[{"1", "-", 
     SuperscriptBox["d", "2"]}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.842373077203538*^9, 3.842373085794341*^9}},
 CellLabel->
  "Out[158]=",ExpressionUUID->"213d2755-7b58-4f8f-bb88-584e3218e5e4"]
}, Open  ]],

Cell["Now identify quasi-monomials x, z, \[Theta], 1/\[Theta], x/\[Theta]", \
"Text",
 CellChangeTimes->{{3.842366398649474*^9, 3.8423664268118773`*^9}, {
  3.842366489091395*^9, 
  3.842366497915888*^9}},ExpressionUUID->"2bb0e126-63ba-4545-93b0-\
b732d8aa7c95"],

Cell["Equations are x, z, \[Theta]", "Text",
 CellChangeTimes->{{3.842366514694412*^9, 
  3.842366526931099*^9}},ExpressionUUID->"653925f8-5cc1-46bd-b33f-\
a508e29872e2"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.842366412519507*^9, 3.842366413675007*^9}},
 CellLabel->
  "In[132]:=",ExpressionUUID->"84653432-7f92-4cdf-97c8-d2385c5c8489"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Collect", "[", 
  RowBox[{
   RowBox[{"d\[Theta]", "/", 
    RowBox[{"\[Theta]", "[", "t", "]"}]}], ",", 
   RowBox[{"\[Theta]", "[", "t", "]"}], ",", "Simplify"}], "]"}]], "Input",
 CellChangeTimes->{{3.842366434042595*^9, 3.842366478466587*^9}},
 CellLabel->
  "In[133]:=",ExpressionUUID->"d995d456-c0ca-470e-a52d-6ff8f88fb22a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "2"}], "-", 
  RowBox[{"x", "[", "t", "]"}], "+", 
  FractionBox[
   RowBox[{"1", "-", 
    SuperscriptBox["d", "2"], "+", 
    RowBox[{"x", "[", "t", "]"}]}], 
   RowBox[{"\[Theta]", "[", "t", "]"}]], "+", 
  RowBox[{"\[Theta]", "[", "t", "]"}]}]], "Output",
 CellChangeTimes->{{3.8423664496674423`*^9, 3.8423664788568773`*^9}, 
   3.842367442842902*^9},
 CellLabel->
  "Out[133]=",ExpressionUUID->"7677b9db-55ef-488f-955f-a5b0fd387c7f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"s", "=", " ", 
  RowBox[{"{", 
   RowBox[{"1", ",", "0", ",", 
    RowBox[{"-", "2"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.8423665030503674`*^9, 3.842366553180932*^9}},
 CellLabel->
  "In[134]:=",ExpressionUUID->"1952b1ce-66c6-4e5d-8b6a-6d22be2daee0"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", "0", ",", 
   RowBox[{"-", "2"}]}], "}"}]], "Output",
 CellChangeTimes->{3.8423665582063513`*^9, 3.8423674428854647`*^9},
 CellLabel->
  "Out[134]=",ExpressionUUID->"52cace80-97d7-4a01-912a-b9c3a236319f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"B", " ", "=", " ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", 
      RowBox[{"-", "1"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"1", ",", "0", ",", 
      RowBox[{"-", "1"}]}], "}"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.842366559883855*^9, 3.842366586476556*^9}},
 CellLabel->
  "In[135]:=",ExpressionUUID->"aa468898-6bbb-45cc-9b04-798f44c8591b"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", 
     RowBox[{"-", "1"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "0", ",", 
     RowBox[{"-", "1"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.842366587358388*^9, 3.842367442927444*^9},
 CellLabel->
  "Out[135]=",ExpressionUUID->"08dfd768-66e9-42fc-9879-ba9099f721c7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"M", " ", "=", " ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"0", ",", 
      RowBox[{"-", "1"}], ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"1", ",", "0", ",", 
      RowBox[{"-", "1"}], ",", "0", ",", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "1"}], ",", "0", ",", "1", ",", 
      RowBox[{"1", "-", 
       RowBox[{"d", "^", "2"}]}], ",", "1"}], "}"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.842366588138011*^9, 3.842366639373433*^9}, {
  3.842366680749131*^9, 3.842366689270026*^9}, {3.84236672934525*^9, 
  3.8423667299084063`*^9}},
 CellLabel->
  "In[136]:=",ExpressionUUID->"7cd4c388-80d7-4fb6-a95c-1c1ee6831913"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"-", "1"}], ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "0", ",", 
     RowBox[{"-", "1"}], ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1"}], ",", "0", ",", "1", ",", 
     RowBox[{"1", "-", 
      SuperscriptBox["d", "2"]}], ",", "1"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.8423666906821337`*^9, 3.842366730273755*^9, 
  3.84236744296944*^9},
 CellLabel->
  "Out[136]=",ExpressionUUID->"d2bcbd94-0990-46d5-b9e3-59f947a9fae0"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"B", "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.8423666992088127`*^9, 3.842366700644404*^9}},
 CellLabel->
  "In[137]:=",ExpressionUUID->"474b968b-b50a-48e8-8a8e-0374aa769fb0"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0"},
     {"0", "1", "0"},
     {"0", "0", "1"},
     {"0", "0", 
      RowBox[{"-", "1"}]},
     {"1", "0", 
      RowBox[{"-", "1"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.842366700982794*^9, 3.842366731967998*^9, 
  3.8423674430120564`*^9},
 CellLabel->
  "Out[137]//MatrixForm=",ExpressionUUID->"49bafbfb-df7b-4eff-b85f-\
30c150c98173"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"M", "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.842366702755755*^9, 3.842366706193556*^9}},
 CellLabel->
  "In[138]:=",ExpressionUUID->"6aac8724-9557-402b-81c7-6bddb50fdaee"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", 
      RowBox[{"-", "1"}], "0", "0", "0"},
     {"1", "0", 
      RowBox[{"-", "1"}], "0", "0"},
     {
      RowBox[{"-", "1"}], "0", "1", 
      RowBox[{"1", "-", 
       SuperscriptBox["d", "2"]}], "1"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.842366706553961*^9, 3.842366732997552*^9}, 
   3.842367443054319*^9},
 CellLabel->
  "Out[138]//MatrixForm=",ExpressionUUID->"f3c18a08-0846-45bf-9153-\
d835daedcc9e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"A", "=", 
  RowBox[{"B", ".", "M"}]}]], "Input",
 CellChangeTimes->{{3.842366692326694*^9, 3.842366694065692*^9}},
 CellLabel->
  "In[139]:=",ExpressionUUID->"4d705b73-bf40-4b3f-912d-8ddeb111366a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"-", "1"}], ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "0", ",", 
     RowBox[{"-", "1"}], ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1"}], ",", "0", ",", "1", ",", 
     RowBox[{"1", "-", 
      SuperscriptBox["d", "2"]}], ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "0", ",", 
     RowBox[{"-", "1"}], ",", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      SuperscriptBox["d", "2"]}], ",", 
     RowBox[{"-", "1"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     RowBox[{"-", "1"}], ",", 
     RowBox[{"-", "1"}], ",", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      SuperscriptBox["d", "2"]}], ",", 
     RowBox[{"-", "1"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.8423666950470543`*^9, 3.8423667340712976`*^9, 
  3.842367443096635*^9},
 CellLabel->
  "Out[139]=",ExpressionUUID->"8bfddea4-5e48-4fa8-a0cd-3a9a1e7ca5d0"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"W", " ", "=", " ", 
  RowBox[{"DiagonalMatrix", "[", 
   RowBox[{"{", 
    RowBox[{"w1", ",", "w2", ",", "w3", ",", "w4", ",", "w5"}], "}"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.842366757628338*^9, 3.8423667709265347`*^9}},
 CellLabel->
  "In[140]:=",ExpressionUUID->"b3196eac-e504-42ff-8b8f-736f34bc7f41"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"w1", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "w2", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "w3", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "w4", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "w5"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.842366771808846*^9, 3.84236744313615*^9},
 CellLabel->
  "Out[140]=",ExpressionUUID->"f3ebdde0-db2b-4ad6-a615-9e56c7e57a5d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"G", " ", "=", " ", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"W", ".", "A"}], " ", "+", " ", 
     RowBox[{"Transpose", "[", 
      RowBox[{"W", ".", "A"}], "]"}]}], ")"}], "/", "2"}]}]], "Input",
 CellChangeTimes->{{3.842366773643022*^9, 3.8423667864116697`*^9}},
 CellLabel->
  "In[141]:=",ExpressionUUID->"96188bf5-5bb0-4a77-83a0-dbcdf3a906f9"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "w1"}], "+", "w2"}], ")"}]}], ",", 
     RowBox[{"-", 
      FractionBox["w3", "2"]}], ",", 
     FractionBox["w4", "2"], ",", 
     FractionBox["w5", "2"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "w1"}], "+", "w2"}], ")"}]}], ",", "0", ",", 
     RowBox[{"-", 
      FractionBox["w2", "2"]}], ",", "0", ",", 
     RowBox[{"-", 
      FractionBox["w5", "2"]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["w3", "2"]}], ",", 
     RowBox[{"-", 
      FractionBox["w2", "2"]}], ",", "w3", ",", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           SuperscriptBox["d", "2"]}], ")"}], " ", "w3"}], "-", "w4"}], 
       ")"}]}], ",", 
     FractionBox[
      RowBox[{"w3", "-", "w5"}], "2"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     FractionBox["w4", "2"], ",", "0", ",", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           SuperscriptBox["d", "2"]}], ")"}], " ", "w3"}], "-", "w4"}], 
       ")"}]}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        SuperscriptBox["d", "2"]}], ")"}], " ", "w4"}], ",", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "w4"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           SuperscriptBox["d", "2"]}], ")"}], " ", "w5"}]}], ")"}]}]}], "}"}],
    ",", 
   RowBox[{"{", 
    RowBox[{
     FractionBox["w5", "2"], ",", 
     RowBox[{"-", 
      FractionBox["w5", "2"]}], ",", 
     FractionBox[
      RowBox[{"w3", "-", "w5"}], "2"], ",", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "w4"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           SuperscriptBox["d", "2"]}], ")"}], " ", "w5"}]}], ")"}]}], ",", 
     RowBox[{"-", "w5"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.842366786922914*^9, 3.842367443179331*^9},
 CellLabel->
  "Out[141]=",ExpressionUUID->"d9b1a63c-3f35-492b-a235-a8fd8dde92aa"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"G", "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.84236678881114*^9, 3.8423667960101337`*^9}},
 CellLabel->
  "In[142]:=",ExpressionUUID->"62421ef9-9484-4864-a712-bed464ff56ef"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", 
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "w1"}], "+", "w2"}], ")"}]}], 
      RowBox[{"-", 
       FractionBox["w3", "2"]}], 
      FractionBox["w4", "2"], 
      FractionBox["w5", "2"]},
     {
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "w1"}], "+", "w2"}], ")"}]}], "0", 
      RowBox[{"-", 
       FractionBox["w2", "2"]}], "0", 
      RowBox[{"-", 
       FractionBox["w5", "2"]}]},
     {
      RowBox[{"-", 
       FractionBox["w3", "2"]}], 
      RowBox[{"-", 
       FractionBox["w2", "2"]}], "w3", 
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", 
            SuperscriptBox["d", "2"]}], ")"}], " ", "w3"}], "-", "w4"}], 
        ")"}]}], 
      FractionBox[
       RowBox[{"w3", "-", "w5"}], "2"]},
     {
      FractionBox["w4", "2"], "0", 
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", 
            SuperscriptBox["d", "2"]}], ")"}], " ", "w3"}], "-", "w4"}], 
        ")"}]}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         SuperscriptBox["d", "2"]}], ")"}], " ", "w4"}], 
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "w4"}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            SuperscriptBox["d", "2"]}], ")"}], " ", "w5"}]}], ")"}]}]},
     {
      FractionBox["w5", "2"], 
      RowBox[{"-", 
       FractionBox["w5", "2"]}], 
      FractionBox[
       RowBox[{"w3", "-", "w5"}], "2"], 
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "w4"}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            SuperscriptBox["d", "2"]}], ")"}], " ", "w5"}]}], ")"}]}], 
      RowBox[{"-", "w5"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.842366790775927*^9, 3.842366796463382*^9}, 
   3.842367443217182*^9},
 CellLabel->
  "Out[142]//MatrixForm=",ExpressionUUID->"36fdb5d7-9b37-423c-b1c7-\
c0940a0e49e5"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"FullSimplify", "[", "G", "]"}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.842366805818746*^9, 3.842366865822486*^9}, {
   3.842367002957333*^9, 3.8423670057523193`*^9}, 3.8423674347860622`*^9, {
   3.842367473590748*^9, 3.8423674740126877`*^9}, 3.84236764387195*^9},
 CellLabel->
  "In[147]:=",ExpressionUUID->"96acb725-52a4-4fe3-87ba-d0bd449bc0a9"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", 
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "w1"}], "+", "w2"}], ")"}]}], 
      RowBox[{"-", 
       FractionBox["w3", "2"]}], 
      FractionBox["w4", "2"], 
      FractionBox["w5", "2"]},
     {
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "w1"}], "+", "w2"}], ")"}]}], "0", 
      RowBox[{"-", 
       FractionBox["w2", "2"]}], "0", 
      RowBox[{"-", 
       FractionBox["w5", "2"]}]},
     {
      RowBox[{"-", 
       FractionBox["w3", "2"]}], 
      RowBox[{"-", 
       FractionBox["w2", "2"]}], "w3", 
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{"w3", "-", 
         RowBox[{
          SuperscriptBox["d", "2"], " ", "w3"}], "-", "w4"}], ")"}]}], 
      FractionBox[
       RowBox[{"w3", "-", "w5"}], "2"]},
     {
      FractionBox["w4", "2"], "0", 
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{"w3", "-", 
         RowBox[{
          SuperscriptBox["d", "2"], " ", "w3"}], "-", "w4"}], ")"}]}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         SuperscriptBox["d", "2"]}], ")"}], " ", "w4"}], 
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "w4"}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            SuperscriptBox["d", "2"]}], ")"}], " ", "w5"}]}], ")"}]}]},
     {
      FractionBox["w5", "2"], 
      RowBox[{"-", 
       FractionBox["w5", "2"]}], 
      FractionBox[
       RowBox[{"w3", "-", "w5"}], "2"], 
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "w4"}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            SuperscriptBox["d", "2"]}], ")"}], " ", "w5"}]}], ")"}]}], 
      RowBox[{"-", "w5"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.842366826244825*^9, 3.8423668662011766`*^9}, 
   3.8423670061699257`*^9, {3.842367435111141*^9, 3.842367443261058*^9}, 
   3.842367474403039*^9, 3.842367644752804*^9},
 CellLabel->
  "Out[147]//MatrixForm=",ExpressionUUID->"e238cb19-9745-401c-847e-\
da6d1e5e5fe4"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"p", " ", "=", " ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"x", " ", "-", " ", "xs"}], ",", " ", 
    RowBox[{"z", " ", "-", " ", "zs"}], ",", " ", 
    RowBox[{"\[Theta]", " ", "-", " ", "\[Theta]s"}], ",", " ", 
    RowBox[{
     RowBox[{"1", " ", "/", "\[Theta]"}], " ", "-", " ", 
     RowBox[{"1", "/", "\[Theta]s"}]}], ",", " ", 
    RowBox[{
     RowBox[{"x", "/", "\[Theta]"}], " ", "-", " ", 
     RowBox[{"xs", " ", "/", " ", "\[Theta]"}]}]}], " ", "}"}]}]], "Input",
 CellChangeTimes->{{3.842367652057296*^9, 3.842367696990923*^9}},
 CellLabel->
  "In[148]:=",ExpressionUUID->"88bc9d51-be6e-4f7e-892c-36ece17938cb"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"x", "-", "xs"}], ",", 
   RowBox[{"z", "-", "zs"}], ",", 
   RowBox[{"\[Theta]", "-", "\[Theta]s"}], ",", 
   RowBox[{
    FractionBox["1", "\[Theta]"], "-", 
    FractionBox["1", "\[Theta]s"]}], ",", 
   RowBox[{
    FractionBox["x", "\[Theta]"], "-", 
    FractionBox["xs", "\[Theta]"]}]}], "}"}]], "Output",
 CellChangeTimes->{3.84236769783806*^9},
 CellLabel->
  "Out[148]=",ExpressionUUID->"ffb90af5-1b20-4aec-8e73-619e2c0bcbb5"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Collect", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"p", ".", "G", ".", "p"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"zs", "\[Rule]", "1"}], ",", 
       RowBox[{"xs", "\[Rule]", 
        RowBox[{"1", "-", 
         RowBox[{"d", "^", "2"}]}]}], ",", 
       RowBox[{"\[Theta]s", " ", "\[Rule]", " ", 
        RowBox[{"1", "-", 
         RowBox[{"d", "^", "2"}]}]}]}], "}"}]}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"w2", "\[Rule]", "w1"}], ",", 
      RowBox[{"w3", "\[Rule]", "0"}], ",", 
      RowBox[{"w5", "\[Rule]", "0"}]}], "}"}]}], ",", 
   RowBox[{"{", "}"}], ",", "FullSimplify"}], "]"}]], "Input",
 CellChangeTimes->{{3.8423676991535387`*^9, 3.842367714524042*^9}, {
   3.842367748122959*^9, 3.842367752325122*^9}, 3.842372923293378*^9, {
   3.8423729756209373`*^9, 3.8423730353696117`*^9}, {3.8423731080158*^9, 
   3.8423732134764442`*^9}, 3.8423732647318087`*^9, {3.8423733079555492`*^9, 
   3.842373349565154*^9}, {3.842373414812047*^9, 3.842373490192376*^9}, {
   3.842373662619339*^9, 3.8423736810827627`*^9}, {3.842373738435955*^9, 
   3.842373813799362*^9}, {3.842373987812523*^9, 3.84237405891553*^9}},
 CellLabel->
  "In[194]:=",ExpressionUUID->"0c4305e6-1052-498f-89e2-59906d4328ab"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", "2"], " ", "w4", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     SuperscriptBox["d", "2"], "+", "x"}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", 
       RowBox[{"1", "-", 
        SuperscriptBox["d", "2"]}]]}], "+", 
     FractionBox["1", "\[Theta]"]}], ")"}]}], "-", 
  RowBox[{
   FractionBox["1", "2"], " ", "w4", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", 
       RowBox[{"1", "-", 
        SuperscriptBox["d", "2"]}]]}], "+", 
     FractionBox["1", "\[Theta]"]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{"1", "-", 
        SuperscriptBox["d", "2"]}], "\[Theta]"]}], "+", 
     FractionBox["x", "\[Theta]"]}], ")"}]}], "-", 
  RowBox[{
   FractionBox["1", "2"], " ", "w1", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "z"}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     SuperscriptBox["d", "2"], "+", "\[Theta]"}], ")"}]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       FractionBox["1", "2"]}], " ", "w1", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "z"}], ")"}]}], "-", 
     RowBox[{
      FractionBox["1", "2"], " ", "w4", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         FractionBox["1", 
          RowBox[{"1", "-", 
           SuperscriptBox["d", "2"]}]]}], "+", 
        FractionBox["1", "\[Theta]"]}], ")"}]}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     SuperscriptBox["d", "2"], "+", "\[Theta]"}], ")"}]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", 
       RowBox[{"1", "-", 
        SuperscriptBox["d", "2"]}]]}], "+", 
     FractionBox["1", "\[Theta]"]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      FractionBox["1", "2"], " ", "w4", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        SuperscriptBox["d", "2"], "+", "x"}], ")"}]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        SuperscriptBox["d", "2"]}], ")"}], " ", "w4", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         FractionBox["1", 
          RowBox[{"1", "-", 
           SuperscriptBox["d", "2"]}]]}], "+", 
        FractionBox["1", "\[Theta]"]}], ")"}]}], "-", 
     RowBox[{
      FractionBox["1", "2"], " ", "w4", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         FractionBox[
          RowBox[{"1", "-", 
           SuperscriptBox["d", "2"]}], "\[Theta]"]}], "+", 
        FractionBox["x", "\[Theta]"]}], ")"}]}], "-", 
     RowBox[{
      FractionBox["1", "2"], " ", "w4", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        SuperscriptBox["d", "2"], "+", "\[Theta]"}], ")"}]}]}], 
    ")"}]}]}]], "Output",
 CellChangeTimes->{{3.8423739921647673`*^9, 3.842374059618417*^9}},
 CellLabel->
  "Out[194]=",ExpressionUUID->"ddf88767-58e0-4746-a679-29ad035253b9"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{"Reduce", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        SuperscriptBox["d", "2"], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           SuperscriptBox["d", "2"]}], ")"}], " ", "z"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", "z"}], ")"}], " ", "\[Theta]"}]}], "\[LessEqual]",
        "0"}], ",", 
      RowBox[{"1", ">", "d", ">", "0"}], ",", 
      RowBox[{"z", ">", "0"}], ",", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", "d"}], ")"}], ">", "\[Theta]", ">", 
       RowBox[{"(", 
        RowBox[{"1", "-", "d"}], ")"}]}]}], "}"}], "]"}], ",", 
   RowBox[{"Assumptions", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"1", ">", "d", ">", "0"}], ",", 
      RowBox[{"z", ">", "0"}], ",", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", "d"}], ")"}], ">", "\[Theta]", ">", 
       RowBox[{"(", 
        RowBox[{"1", "-", "d"}], ")"}]}]}], "}"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.84237382009251*^9, 3.8423738703993273`*^9}, {
  3.842373915454876*^9, 3.84237396720164*^9}},
 CellLabel->
  "In[189]:=",ExpressionUUID->"559b1a9e-6d61-43a4-8775-eab3c8e220d1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{
      SuperscriptBox["d", "2"], "+", "\[Theta]"}], "<", "1"}], "&&", 
    RowBox[{"z", "\[LessEqual]", "1"}]}], ")"}], "||", 
  RowBox[{
   RowBox[{
    SuperscriptBox["d", "2"], "+", "\[Theta]"}], "\[Equal]", "1"}], "||", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{
      SuperscriptBox["d", "2"], "+", "\[Theta]"}], ">", "1"}], "&&", 
    RowBox[{"z", "\[GreaterEqual]", "1"}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.8423738453993273`*^9, 3.842373871027832*^9}, {
  3.842373917738996*^9, 3.842373967902666*^9}},
 CellLabel->
  "Out[189]=",ExpressionUUID->"a56567e5-2f50-412e-a208-b124cddf687e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Reduce", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox["d", "2"]}], " ", "w5"}], "-", 
      FractionBox[
       RowBox[{"2", " ", 
        SuperscriptBox["d", "2"], " ", "w5", " ", "x"}], 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        SuperscriptBox["d", "2"]}]], "-", 
      FractionBox[
       RowBox[{
        SuperscriptBox["d", "2"], " ", "w5", " ", 
        SuperscriptBox["x", "2"]}], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          SuperscriptBox["d", "2"]}], ")"}], "2"]]}], "\[LessEqual]", "0"}], 
    ",", 
    RowBox[{"1", ">", "d", ">", "0"}], ",", 
    RowBox[{"x", ">", "0"}], ",", 
    RowBox[{"w5", ">", "0"}]}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.842373695906322*^9, 3.842373717894261*^9}},
 CellLabel->
  "In[176]:=",ExpressionUUID->"c5f1b29b-ee25-4c45-a0de-d73ae8216986"],

Cell[BoxData[
 RowBox[{
  RowBox[{"x", ">", "0"}], "&&", 
  RowBox[{"w5", ">", "0"}], "&&", 
  RowBox[{"0", "<", "d", "<", "1"}]}]], "Output",
 CellChangeTimes->{3.842373718401339*^9},
 CellLabel->
  "Out[176]=",ExpressionUUID->"9505ff60-d3fc-4826-8d6f-6d40485d2d68"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Reduce", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{"3", "-", 
          RowBox[{"2", " ", 
           SuperscriptBox["d", "2"]}]}], ")"}], " ", "w4"}], 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        SuperscriptBox["d", "2"]}]], "+", 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          SuperscriptBox["d", "2"]}], ")"}], " ", "w4"}], 
       SuperscriptBox["\[Theta]", "2"]], "-", 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "3"}], "+", 
          SuperscriptBox["d", "2"]}], ")"}], " ", "w4"}], "\[Theta]"], "+", 
      FractionBox[
       RowBox[{"w4", " ", "\[Theta]"}], 
       RowBox[{"1", "-", 
        SuperscriptBox["d", "2"]}]]}], " ", "<=", " ", "0"}], ",", 
    RowBox[{"1", ">", "d", ">", "0"}], ",", 
    RowBox[{"w4", "\[GreaterEqual]", "0"}], ",", 
    RowBox[{"\[Theta]", ">", "0"}]}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.84237351366574*^9, 3.842373565368307*^9}},
 CellLabel->
  "In[173]:=",ExpressionUUID->"c752a51c-fc1f-4010-8491-ec27784f78d8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"0", "<", "d", "<", "1"}], "&&", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"0", "<", "\[Theta]", "\[LessEqual]", "1"}], "&&", 
      RowBox[{"w4", "\[GreaterEqual]", "0"}]}], ")"}], "||", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"\[Theta]", ">", "1"}], "&&", 
      RowBox[{"w4", "\[Equal]", "0"}]}], ")"}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.842373548581278*^9, 3.842373565826207*^9}},
 CellLabel->
  "Out[173]=",ExpressionUUID->"e6d9d6ab-b655-4e30-acae-d30e70ba44c3"]
}, Open  ]]
},
WindowSize->{927, 1145},
WindowMargins->{{Automatic, 0}, {0, Automatic}},
PrintingCopies->1,
PrintingPageRange->{Automatic, Automatic},
PrintingOptions->{"PaperOrientation"->"Portrait",
"PaperSize"->{Automatic, Automatic},
"PostScriptOutputFile"->""},
FrontEndVersion->"11.3 for Linux x86 (64-bit) (March 6, 2018)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 227, 4, 31, "Input",ExpressionUUID->"0a376c8b-5438-4500-9389-a272f1f6bf6f"],
Cell[CellGroupData[{
Cell[810, 28, 558, 17, 31, "Input",ExpressionUUID->"9019f713-677f-4a78-b147-7f02b02d6938"],
Cell[1371, 47, 542, 17, 53, "Output",ExpressionUUID->"453d73e1-8f9e-4bed-81d5-3ef0594e65d2"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1950, 69, 558, 17, 31, "Input",ExpressionUUID->"61d84857-1bd8-416f-a38b-f82108d7fcf6"],
Cell[2511, 88, 546, 17, 53, "Output",ExpressionUUID->"c09efc81-b6ff-41da-b275-fdd43f7802b6"]
}, Open  ]],
Cell[CellGroupData[{
Cell[3094, 110, 382, 10, 31, "Input",ExpressionUUID->"b9fdbe58-b54a-4445-88e4-af73e6b51f4f"],
Cell[3479, 122, 373, 10, 35, "Output",ExpressionUUID->"84e1b5b6-e9b1-497c-b729-9426a31d1350"]
}, Open  ]],
Cell[CellGroupData[{
Cell[3889, 137, 609, 17, 31, "Input",ExpressionUUID->"19562127-2b7f-404f-8cc7-b60485561365"],
Cell[4501, 156, 589, 18, 54, "Output",ExpressionUUID->"9a65f59a-c146-461a-b9d0-dc8840c32831"]
}, Open  ]],
Cell[5105, 177, 255, 6, 58, "Text",ExpressionUUID->"a486fd75-f594-4e76-bb72-7e9ab8d1839d"],
Cell[CellGroupData[{
Cell[5385, 187, 1144, 33, 31, "Input",ExpressionUUID->"3dcec831-8193-4176-a20a-45946938e0aa"],
Cell[6532, 222, 1005, 31, 54, "Output",ExpressionUUID->"3eb93761-2a39-45b0-bec5-b61d7f234961"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7574, 258, 812, 24, 34, "Input",ExpressionUUID->"cba74860-1e44-4960-9665-52dc01cc6148"],
Cell[8389, 284, 369, 10, 35, "Output",ExpressionUUID->"30e813c6-10a3-4ba8-b31c-079e2b058630"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8795, 299, 1219, 36, 59, "Input",ExpressionUUID->"c41e5fa6-24b0-4d5b-a47e-e4d9539c228d"],
Cell[10017, 337, 478, 13, 37, "Output",ExpressionUUID->"a66e592e-8c88-4027-8977-32149b78a164"]
}, Open  ]],
Cell[CellGroupData[{
Cell[10532, 355, 272, 6, 31, "Input",ExpressionUUID->"9052f7bf-4079-4ea4-a8be-f14fda4f6bb2"],
Cell[10807, 363, 369, 11, 35, "Output",ExpressionUUID->"f6802ad5-ea27-4e91-9508-d30f3e742be7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[11213, 379, 619, 17, 31, "Input",ExpressionUUID->"668d40c6-8b43-437e-a808-db5eb45a9d3a"],
Cell[11835, 398, 523, 15, 40, "Output",ExpressionUUID->"213d2755-7b58-4f8f-bb88-584e3218e5e4"]
}, Open  ]],
Cell[12373, 416, 262, 5, 35, "Text",ExpressionUUID->"2bb0e126-63ba-4545-93b0-b732d8aa7c95"],
Cell[12638, 423, 170, 3, 35, "Text",ExpressionUUID->"653925f8-5cc1-46bd-b33f-a508e29872e2"],
Cell[12811, 428, 175, 3, 31, "Input",ExpressionUUID->"84653432-7f92-4cdf-97c8-d2385c5c8489"],
Cell[CellGroupData[{
Cell[13011, 435, 354, 8, 31, "Input",ExpressionUUID->"d995d456-c0ca-470e-a52d-6ff8f88fb22a"],
Cell[13368, 445, 477, 13, 61, "Output",ExpressionUUID->"7677b9db-55ef-488f-955f-a5b0fd387c7f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[13882, 463, 282, 7, 31, "Input",ExpressionUUID->"1952b1ce-66c6-4e5d-8b6a-6d22be2daee0"],
Cell[14167, 472, 253, 6, 35, "Output",ExpressionUUID->"52cace80-97d7-4a01-912a-b9c3a236319f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[14457, 483, 634, 18, 31, "Input",ExpressionUUID->"aa468898-6bbb-45cc-9b04-798f44c8591b"],
Cell[15094, 503, 587, 17, 35, "Output",ExpressionUUID->"08dfd768-66e9-42fc-9879-ba9099f721c7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[15718, 525, 728, 19, 31, "Input",ExpressionUUID->"7cd4c388-80d7-4fb6-a95c-1c1ee6831913"],
Cell[16449, 546, 610, 17, 40, "Output",ExpressionUUID->"d2bcbd94-0990-46d5-b9e3-59f947a9fae0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[17096, 568, 210, 4, 31, "Input",ExpressionUUID->"474b968b-b50a-48e8-8a8e-0374aa769fb0"],
Cell[17309, 574, 893, 27, 119, "Output",ExpressionUUID->"49bafbfb-df7b-4eff-b85f-30c150c98173"]
}, Open  ]],
Cell[CellGroupData[{
Cell[18239, 606, 208, 4, 31, "Input",ExpressionUUID->"6aac8724-9557-402b-81c7-6bddb50fdaee"],
Cell[18450, 612, 958, 28, 87, "Output",ExpressionUUID->"f3c18a08-0846-45bf-9153-d835daedcc9e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[19445, 645, 221, 5, 31, "Input",ExpressionUUID->"4d705b73-bf40-4b3f-912d-8ddeb111366a"],
Cell[19669, 652, 1048, 32, 40, "Output",ExpressionUUID->"8bfddea4-5e48-4fa8-a0cd-3a9a1e7ca5d0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[20754, 689, 339, 8, 31, "Input",ExpressionUUID->"b3196eac-e504-42ff-8b8f-736f34bc7f41"],
Cell[21096, 699, 652, 16, 35, "Output",ExpressionUUID->"f3ebdde0-db2b-4ad6-a615-9e56c7e57a5d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[21785, 720, 384, 10, 31, "Input",ExpressionUUID->"96188bf5-5bb0-4a77-83a0-dbcdf3a906f9"],
Cell[22172, 732, 2602, 90, 176, "Output",ExpressionUUID->"d9b1a63c-3f35-492b-a235-a8fd8dde92aa"]
}, Open  ]],
Cell[CellGroupData[{
Cell[24811, 827, 209, 4, 31, "Input",ExpressionUUID->"62421ef9-9484-4864-a712-bed464ff56ef"],
Cell[25023, 833, 2927, 99, 179, "Output",ExpressionUUID->"36fdb5d7-9b37-423c-b1c7-c0940a0e49e5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[27987, 937, 396, 7, 31, "Input",ExpressionUUID->"96acb725-52a4-4fe3-87ba-d0bd449bc0a9"],
Cell[28386, 946, 2899, 94, 179, "Output",ExpressionUUID->"e238cb19-9745-401c-847e-da6d1e5e5fe4"]
}, Open  ]],
Cell[CellGroupData[{
Cell[31322, 1045, 651, 15, 31, "Input",ExpressionUUID->"88bc9d51-be6e-4f7e-892c-36ece17938cb"],
Cell[31976, 1062, 486, 14, 53, "Output",ExpressionUUID->"ffb90af5-1b20-4aec-8e73-619e2c0bcbb5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[32499, 1081, 1273, 29, 55, "Input",ExpressionUUID->"0c4305e6-1052-498f-89e2-59906d4328ab"],
Cell[33775, 1112, 3171, 108, 158, "Output",ExpressionUUID->"ddf88767-58e0-4746-a679-29ad035253b9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[36983, 1225, 1304, 38, 69, InheritFromParent,ExpressionUUID->"559b1a9e-6d61-43a4-8775-eab3c8e220d1"],
Cell[38290, 1265, 692, 20, 40, "Output",ExpressionUUID->"a56567e5-2f50-412e-a208-b124cddf687e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[39019, 1290, 975, 30, 68, "Input",ExpressionUUID->"c5f1b29b-ee25-4c45-a0de-d73ae8216986"],
Cell[39997, 1322, 267, 7, 35, "Output",ExpressionUUID->"9505ff60-d3fc-4826-8d6f-6d40485d2d68"]
}, Open  ]],
Cell[CellGroupData[{
Cell[40301, 1334, 1226, 37, 63, "Input",ExpressionUUID->"c752a51c-fc1f-4010-8491-ec27784f78d8"],
Cell[41530, 1373, 551, 15, 35, "Output",ExpressionUUID->"e6d9d6ab-b655-4e30-acae-d30e70ba44c3"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)

