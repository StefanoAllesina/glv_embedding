---
title: Stability of ecological and epidemiological models via representation as Generalized Lotka-Volterra dynamics
authors:
  - name: Stefano Allesina 
    thanks: stefanoallesina.github.io
    department: Department of Ecology & Evolution
    affiliation: University of Chicago
    location: Chicago, IL 60637 USA
    email: sallesina@uchicago.edu
  - name: Zachary R. Miller
    department: Department of Ecology & Evolution
    affiliation: University of Chicago
    email: zachmiller@uchicago.edu
abstract: |
  Enter the text of your abstract here.
keywords:
  - Lotka-Volterra
  - Stability
  - Quasi-polynomial 
  - Lyapunov function
bibliography: references.bib
biblio-style: unsrt
header-includes: 
  - \usepackage{amsmath}
  - \usepackage{xcolor}
  - \usepackage{fancybox}
output: rticles::arxiv_article
---

# Introduction

Several models for ecological, evolutionary, and epidemiological dynamics can be recast as a Generalized Lotka-Volterra model via the so-called *quasi-monomial transformation*. This transformation was discovered in the late 1980s at least three times (as far as we can tell, independently) by different authors  [@peschel1986predator, @brenig1988complete, @gouze1990transformation]. 

# Generalized Lotka-Volterra model
\label{sec:glv}

\begin{equation}
\label{eq:glv}
\dot{x}_i = x_i \left(r_i + \sum_{j=1}^m A_{ij} x_j \right)
\end{equation}

# Quasi-Polynomial systems
\label{sec:qp}

We now introduce a generalization of Eq. \ref{eq:glv}, defining the class of quasi-polynomial systems (QP-systems):

\begin{equation}
\label{eq:qp}
\dot{y}_i = y_i \left( s_i + \sum_{j = 1}^m M_{ij} \prod_{k = 1}^n y_k^{B_{jk}} \right)
\end{equation}

where we have $n$ equations, $\dot{y}_1, \ldots, \dot{y}_n$. The vector $s$ is of length $n$, $M$ is a matrix of size $n \times m$ containing real coefficients, and $B$ a matrix of size $m \times n$, also containing real coefficients. If $n = m$, and thus both $M$ and $B$ are square matrices, and further that $B=I_n$ (the identity matrix of size $n$), the model reduces to the Generalized Lotka-Volterra model in Eq. \ref{eq:glv} with $r = s$ and $A = M$. If $B$ contains only integers, Eq. \ref{eq:qp} defines a *polynomial* system of differential equations; relaxing this condition to admit $B$ composed of real numbers, we obtain a *quasi-polynomial* (QP-) system.

****

**QP-representation of Leslie-Gower predator-prey model**

The Leslie-Gower model is simple variation on the classic Lotka-Volterra predator-prey model. We have two equations:

\begin{equation}
\label{eq:lg}
\begin{cases}
\dot{y}_1 = y_1 (\rho_1 - y_1- \alpha_1 y_2)\\
\dot{y}_2 = y_2 \left(\rho_2 - \alpha_2 \frac{y_2}{y_1} \right)
\end{cases}
\end{equation}

with $y_1$ representing the prey, $y_2$ the predator, and all coefficients are assumed to be positive. The system differs from GLV in that we have a ratio between the predator and prey in the equation for the predator. The system is however in QP form, as seen by defining:

\begin{equation}
\label{eq:lgqp}
s = \begin{pmatrix}
\rho_1\\
\rho_2
\end{pmatrix} \quad 
M = \begin{pmatrix}
-1 & -\alpha_1 & 0\\
0 & 0 & -\alpha_2
\end{pmatrix} \quad
B = \begin{pmatrix}
1 & 0 \\
0 & 1 \\
1 & -1
\end{pmatrix}
\end{equation}

****

# From Quasi-Polynomial to Generalized Lotka-Volterra
\label{sec:qptoglv}

We define a set of $m$ *quasi-monomials*:

\begin{equation}
\label{eq:quasimono}
x_j = \prod_{k=1}^n y_k^{B_{jk}}
\end{equation}

A simple way to identify quasi-monomials for any system that can be written in QP form is to consider the per capita dynamics:

\begin{equation}
\dot{\log y}_i = \frac{\dot{y}_i}{y_i} = s_i + \sum_{j = 1}^m M_{ij} \prod_{k = 1}^n y_k^{B_{jk}}
\end{equation}

As such, the set of variables, or product of powers of variables, appearing in the equations for the equations $\dot{\log y}_i$  defines the quasi-monomials $x$.

****

**Quasi-monomials for the Leslie-Gower model**

For the Leslie-Gower model in Eq. \ref{eq:lg} we identify three quasi-monomials:

\begin{equation}
\label{eq:lgqm}
\begin{cases}
x_1 = y_1^1 \, y_2^0 = y_1\\
x_2 = y_1^0 \, y_2^1 = y_2\\
x_3 = y_1^{-1} \, y_2^1 = \frac{y_2}{y_1}
\end{cases}
\end{equation}

****

Now we show how the $n-$dimensional QP-system of differential equations in Eq. \ref{eq:qp} can be recast as an $m-$dimensional GLV system in Eq. \ref{eq:glv}. By chain rule, we have:

\begin{equation}
\label{eq:quasimonodt}
\begin{aligned}
\dot{x}_j &= \sum_k B_{jk}\, \dot{y}_k \, y_{k}^{(B_{jk} -1)} \prod_{l \neq k} y_{l}^{B_{jl}}\\
&=\sum_k B_{jk}\, \frac{\dot{y}_k}{y_k} \prod_{l} y_{l}^{B_{jl}}\\
&=\sum_k B_{jk}\, \frac{\dot{y}_k}{y_k} x_j\\
&=x_j \sum_k B_{jk}\, \frac{\dot{y}_k}{y_k} \\
&=x_j \left(\sum_k B_{jk} s_k + \sum_k B_{jk} \sum_l M_{kl} \prod_l y_l^{B_{kl}} \right)\\
&=x_j \left(\sum_k B_{jk} s_k + \sum_k B_{jk} \sum_l M_{kl} x_l \right)\\
&=x_j \left((B s)_j + \sum_l (B M)_{jl} x_l \right)\\
&=x_j \left(r_j + \sum_l A_{jl} x_l \right)
\end{aligned}
\end{equation}

where we have defined $A = BM$ and $r = B s$; $(Bs)_j$ is the $j^{\text{th}}$ element of the vector $Bs$ and $(B M)_{jl}$ is the coefficient in row $j$ and column $l$ of the matrix $BM$. 

Via the quasi-monomial transformation in Eq. \ref{eq:quasimono} we have turned the $n-$dimensional QP-system in Eq. \ref{eq:qp} into an $m-$dimensional GLV system in Eq. \ref{eq:glv}.

****

**GLV representation of the Leslie-Gower model**

We can represent the Leslie-Gower model in Eq. \ref{eq:lg} as a three-dimensional GLV model defined by the quasi-monomials in Eq. \ref{eq:lgqm} and:

\begin{equation}
r = B s = \begin{pmatrix}
\rho_1\\
\rho_2\\
\rho_2 - \rho_1
\end{pmatrix}
\quad
A = B M = \begin{pmatrix}
-1 & -\alpha_1 & 0\\
0 & 0 & -\alpha_2\\
1 & \alpha_1 & -\alpha_2
\end{pmatrix}
\end{equation}

Note that $A$ is rank deficient, given that the third row can be written as the difference between the second and first row. Rank-deficiency of $A$ is expected whenever $m > n$ (as here, where we went from two to three equations).

The GLV representation of the model becomes:

\begin{equation}
\label{eq:lgglv}
\begin{cases}
\dot{x}_1 = x_1 (\rho_1 - x_1 - \alpha_1 x_2)\\
\dot{x}_2 = x_2 (\rho_2 - \alpha_2 x_3)\\
\dot{x}_3 = x_3 (\rho_2 - \rho_1 + \alpha_1 x_1 - \alpha_2 x_3)
\end{cases}
\end{equation}

****

# Stability in Generalized Lotka-Volterra

## Lyapunov's direct method

Provided with a dynamical system $\dot{y}_i$ 

## Candidate Lyapunov function for Generalized-Lotka Volterra

Before proceeding, we note that if Eq. \ref{eq:glv} has a feasible (i.e., positive) coexistence equilibrium, then $r = -A x^\star$, and as such we can rewrite the equations more compactly as $\dot{x}_i = x_i \sum_{j} A_{ij} (x_j - x_j^\star) = x_i \sum_{j} A_{ij} \Delta x_j$, where we have defined the deviation from equilibrium $\Delta x_j = x_j - x_j^\star$.

We now consider the candidate Lyapunov function proposed by Goh:

\begin{equation}
\label{eq:goh}
\begin{cases}
V_{x_i} = x_i - x_i^\star - x_i^\star \log \frac{x_i}{x_i^\star}\\
V = \sum_i w_i V_{x_i}
\end{cases}
\end{equation}

where each $V_{x_i} > 0$ for any positive $x_i \neq x_i^\star$ and zero at the equilibrium. The weights $w_1, \ldots w_n$ are non-negative, and at least one is positive. In such cases, $V$ is radially unbounded. If we can find weights such that $\dot{V} = \sum_i w_i \dot{V}_{x_i} \leq 0$, we can prove stability (possibly, through LaSalle's invariance principle). Deriving:

\begin{equation}
\label{eq:gohstab}
\begin{aligned}
\dot{V} =& \sum_i w_i \left(\dot{x}_i - x_i^\star \dot{\log x_i} \right)\\
 =& \sum_i w_i \left(x_i \sum_{j} A_{ij} \Delta x_j - x_i^\star \sum_j A_{ij} \Delta x_j \right)\\
 =& \sum_i w_i \left(\Delta x_i \sum_{j} A_{ij} \Delta x_j \right)\\
 =& \sum_i \Delta x_i w_i \sum_j A_{ij} \Delta x_j\\
 =& \sum_i \sum_j w_i A_{ij} \Delta x_i \Delta x_j
\end{aligned}
\end{equation}

Note that in the sum over $i$ and $j$, only the symmetric part of the matrix $D(w) A = (w_i A_{ij})$ matters (the skew symmetric part cancels). It is therefore convenient to define a new, symmetric matrix $G =\frac{1}{2} (D(w)A + A^T D(w))$, so that our expression becomes:

\begin{equation}
\label{eq:stabcond}
\dot{V} = \frac{1}{2}\sum_i \sum_j (w_i A_{ij} + A_{ji} w_j) \Delta x_i \Delta x_j = \sum_i \sum_j G_{ij} \Delta x_i \Delta x_j
\end{equation}

A symmetric matrix $G$ satisfying $z^T G z = \sum_i \sum_j G_{ij} z_i z_j < 0$ for every $z \neq 0$ is called *negative definite*. If the sum can be zero for some $z \neq 0$, $G$ is called *negative semi-definite*. A symmetric, negative definite matrix has all eigenvalues real and negative; in a negative semi-definite matrix eigenvalues can be zero. As such, if we can identify suitable, positive (nonnegative) weights $w$ such that $G$ is negative (semi-)definite, then $\dot{V} \leq 0$ and we can prove the stability of the equilibrium $x^\star$.

## Stability in QP-systems

In the Generalized Lotka-Volterra model in Eq. \ref{eq:glv}, the variables $x_i$ can in principle take any positive value (at least as an initial condition), and therefore each $\Delta x_i$ is radially unbounded: $\Delta x_i \in [-x_i^\star, \infty)$; moreover, we can set (again, at least initially) each $x_i$ to any arbitrary value, irrespective of the value of the rest of the $x_j$. In such a setting, it is therefore difficult to prove stability via Eq. \ref{eq:stabcond} if the matrix $G$ is not negative (semi-)definite. 

Note however that, when we represent an $n-$dimensional QP-system using an $m-$dimensional GLV system, the quasi monomials $x_i$ are function of the original variables $y_i$. This in turn means that the perturbations in the GLV system are a function of the perturbations in the original system: in particular $\Delta x_i  = \prod_{k=1}^n y_k^{B_{ik}} - \prod_{k=1}^n (y_k^\star)^{B_{ik}}$.

In practice, this means that not all perturbations $\Delta x$ are allowed---rather, only those compatible with the definition of the quasi-monomials. In turn, this means that we could (and often will) find nonnegative weights in Eq. \ref{eq:stabcond} such that $\dot{V} \leq 0$ and yet the matrix $G$ *is not negative semi-definite*. In such cases, $G$ *acts* like a negative semi-definite matrix on the *admissible* perturbations, i.e., those abiding by the form specified by the quasi-monomials. 

****

**Stability of the Leslie-Gower model**

We consider the candidate Lyapunov function in Eq. \ref{eq:goh} for the QP-representation of the Leslie-Gower model (Eq. \ref{eq:lgglv}). A convenient choice of weights is $w = (0, \rho_1 \alpha_1 + \alpha_2, \rho_2 \alpha_2 )^T$, yielding:

\begin{equation}
G =\frac{1}{2} (D(w)A + A^T D(w)) =
\begin{pmatrix}
0 & 0 & \frac{\rho_2 \alpha_2}{2} \\
0 & 0 & -\frac{\alpha_2^2}{2} \\
\frac{\rho_2 \alpha_2}{2} & -\frac{\alpha_2^2}{2} & -\rho_2 \alpha_2^2
\end{pmatrix}
\end{equation}

****


# Examples

```{r child=here::here("paper", "GLV_embedding", "sir.Rmd")}

```

```{r child=here::here("paper", "GLV_embedding", "consumer_resource.Rmd")}

```

```{r child=here::here("paper", "GLV_embedding", "hoi.Rmd")}

```



## Commented bibliography

Thesis @szederkenyi2012computational and book @szederkenyi2018analysis





You can insert references. Here is some text [@kour2014real; @kour2014fast] and see @hadash2018estimate.

