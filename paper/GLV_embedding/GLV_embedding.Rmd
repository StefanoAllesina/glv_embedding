---
title: Stability of ecological and epidemiological models via representation as Generalized Lotka-Volterra dynamics
authors:
  - name: Stefano Allesina 
    thanks: stefanoallesina.github.io
    department: Department of Ecology & Evolution
    affiliation: University of Chicago
    location: Chicago, IL 60637 USA
    email: sallesina@uchicago.edu
  - name: Zachary R. Miller
    department: Department of Ecology & Evolution
    affiliation: University of Chicago
    email: zachmiller@uchicago.edu
abstract: |
  Enter the text of your abstract here.
keywords:
  - Lotka-Volterra
  - Stability
  - Quasi-polynomial 
  - Lyapunov function
bibliography: references.bib
biblio-style: unsrt
header-includes: 
  - \usepackage{amsmath}
  - \usepackage{xcolor}
output: rticles::arxiv_article
---

# Introduction

Blah, blah

# Generalized Lotka-Volterra model
\label{sec:glv}

\begin{equation}
\label{eq:glv}
\dot{x}_i = x_i \left(r_i + \sum_{j=1}^m A_{ij} x_j \right)
\end{equation}

# Quasi-Polynomial systems
\label{sec:qp}

\begin{equation}
\label{eq:qp}
\dot{y}_i = y_i \left( \lambda_i + \sum_{j = 1}^m M_{ij} \prod_{k = 1}^n y_k^{B_{jk}} \right)
\end{equation}

where $\lambda$ is a vector of length $n$; $M$ is a matrix of size $n \times m$ containing real coefficients, and $B$ a matrix of size $m \times n$, also containing real coefficients. If $n = m$, and thus $M$ is a square matrix, and $B=I_n$ the model reduces to the Generalized Lotka-Volterra model in Eq. \ref{eq:glv} with $r = \lambda$ and $A = M$. If $B$ contains only integers, Eq. \ref{eq:qp} defines a *polynomial* system of differential equations; relaxing this condition to admit $B$ composed of real numbers, we obtain a *quasi-polynomial* (QP) system.

****

**QP-representation of Leslie-Gower predator-prey model**

\begin{equation}
\label{eq:lg}
\begin{cases}
\dot{y}_1 = y_1 (\rho_1 - y_1- \alpha_1 y_2)\\
\dot{y}_2 = y_2 \left(\rho_2 - \alpha_2 \frac{y_2}{y_1} \right)
\end{cases}
\end{equation}

with $y_1$ being the prey, $y_2$ the predator, and all coefficients positive. The system differs from GLV in that we have a ratio between the predator and prey in the equation for the predator. The system is however in QP form, as seen by defining:

\begin{equation}
\label{eq:lgqp}
\lambda = \begin{pmatrix}
\rho_1\\
\rho_2
\end{pmatrix} \quad 
M = \begin{pmatrix}
-1 & -\alpha_1 & 0\\
0 & 0 & -\alpha_2
\end{pmatrix} \quad
B = \begin{pmatrix}
1 & 0 \\
0 & 1 \\
1 & -1
\end{pmatrix}
\end{equation}

****


# From Quasi-Polynomial to Generalized Lotka-Volterra
\label{sec:qptoglv}

We define a set of $m$ *quasi-monomials*:

\begin{equation}
\label{eq:quasimono}
x_j = \prod_{k=1}^n y_k^{B_{jk}}
\end{equation}

****

**Quasi-monomials for the Leslie-Gower model**

For the Leslie-Gower model in Eq. \ref{eq:lg} we identify three quasi-monomials:

\begin{equation}
\label{eq:lgqm}
\begin{cases}
x_1 = y_1^1 \, y_2^0 = y_1\\
x_2 = y_1^0 \, y_2^1 = y_2\\
x_3 = y_1^{-1} \, y_2^1 = \frac{y_2}{y_1}
\end{cases}
\end{equation}

****

By chain rule, we have:

\begin{equation}
\label{eq:quasimonodt}
\begin{aligned}
\dot{x}_j &= \sum_k B_{jk}\, \dot{y}_k \, y_{k}^{(B_{jk} -1)} \prod_{l \neq k} y_{l}^{B_{jl}}\\
&=\sum_k B_{jk}\, \frac{\dot{y}_k}{y_k} \prod_{l} y_{l}^{B_{jl}}\\
&=\sum_k B_{jk}\, \frac{\dot{y}_k}{y_k} x_j\\
&=x_j \sum_k B_{jk}\, \frac{\dot{y}_k}{y_k} \\
&=x_j \left(\sum_k B_{jk} \lambda_k + \sum_k B_{jk} \sum_l M_{kl} \prod_l y_l^{B_{kl}} \right)\\
&=x_j \left(\sum_k B_{jk} \lambda_k + \sum_k B_{jk} \sum_l M_{kl} x_l \right)\\
&=x_j \left((B \lambda)_j + \sum_l (B M)_{jl} x_l \right)\\
&=x_j \left(r_j + \sum_l A_{jl} x_l \right)
\end{aligned}
\end{equation}

where we have defined $A = BM$ and $r = B \lambda$, $(B\lambda)_j$ is the $j^{\text{th}}$ element of the vector $B\lambda$ and $(B M)_{jl}$ is the coefficient in row $j$ and column $l$ of the matrix $BM$. 

Via the quasi-monomial transformation in Eq. \ref{eq:quasimono} we have turned the $n-$dimensional QP-system in Eq. \ref{eq:qp} into an $m-$dimensional GLV system in Eq. \ref{eq:glv}.

****

**GLV representation of the Leslie-Gower model**

We can represent the Leslie-Gower model in Eq. \ref{eq:lg} as a three-dimensional GLV model defined by the quasi-monomials in Eq. \ref{eq:lgqm} and:

\begin{equation}
r = B \lambda = \begin{pmatrix}
\rho_1\\
\rho_2\\
\rho_2 - \rho_1
\end{pmatrix}
\quad
A = B M = \begin{pmatrix}
-1 & -\alpha_1 & 0\\
0 & 0 & -\alpha_2\\
1 & \alpha_1 & -\alpha_2
\end{pmatrix}
\end{equation}

Note that $A$ is rank deficient, given that the third row can be written as the difference between the second and first row. Rank-deficiency of $A$ is expected whenever $m > n$ (as here, where we went from two to three equations).

****


# Examples of citations, figures, tables, references
\label{sec:others}

You can insert references. Here is some text [@kour2014real; @kour2014fast] and see @hadash2018estimate.

The documentation for \verb+natbib+ may be found at

You can use custom blocks with LaTeX support from **rmarkdown** to create environment.

::: {.center latex=true}
  <http://mirrors.ctan.org/macros/latex/contrib/natbib/natnotes.pdf}>
:::

Of note is the command \verb+\citet+, which produces citations
appropriate for use in inline text.  

You can insert LaTeX environment directly too.

\begin{verbatim}
   \citet{hasselmo} investigated\dots
\end{verbatim}

produces

\begin{quote}
  Hasselmo, et al.\ (1995) investigated\dots
\end{quote}

\begin{center}
  \url{https://www.ctan.org/pkg/booktabs}
\end{center}


## Figures

You can insert figure using LaTeX directly. 

See Figure \ref{fig:fig1}. Here is how you add footnotes. [^Sample of the first footnote.]

\begin{figure}
  \centering
  \fbox{\rule[-.5cm]{4cm}{4cm} \rule[-.5cm]{4cm}{0cm}}
  \caption{Sample figure caption.}
  \label{fig:fig1}
\end{figure}

But you can also do that using R.

```{r fig2, fig.cap = "Another sample figure"}
plot(mtcars$mpg)
```

You can use **bookdown** to allow references for Tables and Figures.


## Tables

Below we can see how to use tables. 

See awesome Table~\ref{tab:table} which is written directly in LaTeX in source Rmd file.

\begin{table}
 \caption{Sample table title}
  \centering
  \begin{tabular}{lll}
    \toprule
    \multicolumn{2}{c}{Part}                   \\
    \cmidrule(r){1-2}
    Name     & Description     & Size ($\mu$m) \\
    \midrule
    Dendrite & Input terminal  & $\sim$100     \\
    Axon     & Output terminal & $\sim$10      \\
    Soma     & Cell body       & up to $10^6$  \\
    \bottomrule
  \end{tabular}
  \label{tab:table}
\end{table}

You can also use R code for that.

```{r}
knitr::kable(head(mtcars), caption = "Head of mtcars table")
```


## Lists

- Item 1
- Item 2 
- Item 3
